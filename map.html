<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">

    <title>UPC INTERACTIVE MAP</title>
    <link rel="stylesheet" href="css/map/reset.css">
    <link rel="stylesheet" href="css/map/style.css">
    <link rel="stylesheet" href="css/popup/floorplan.css">
    <link rel="stylesheet" href="css/popup/style.css">
    <link rel="stylesheet" href="css/sidebar/demo.css">
    <link rel="stylesheet" href="css/sidebar/component.css">
    <link rel="stylesheet" href="css/floorplans_proto.css">
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/panzoom.js"></script> 
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  </head>

  <body ng-app="myApp" ng-controller="MainController">
    <section id="st-container">
      <div class="containerz" style=" height: 100%; width: 100%;">

      <div id="panzoom" class="distribution-map" style="width:964px; height:625px"> 
      	<img class = "mapimg" id = "image1" src="images/map.png" style="height:625px; width:1000">
      	<span ng-repeat="x in pins">
	      	<div class="cd-popup-trigger">
	      		<button class="map-point" style="top:{{x.t}};left:{{x.l}}; height:1px, width:1px" data-effect="st-effect-1" ng-click="setDetails(x)">
	              	<img id = "image1" src="images/pin.png" width="50" height="50" style="bottom:10px;right:25px">
	          	</button>
	        </div>
      	</span>     
      </div>
      </div>

      <div class="margin-div"  >
        <button class="button button5" onclick=newDoc()>H O M E</button>
        <button class="button button1">R E S E T</button>
      </div>

      <div class="cd-popup" style="position: fixed;left: 0;top: 0;" >
        <div class="cd-popup-container" >
          <h2> {{ title }} </h2>
          <p><strong>Description:</strong></p>
          <p>{{ description }}</p>
          <li style="position: fixed; bottom:10%; width:100%">
            <button id = "flrpln" style="width: 100%" ng-show="title=='UNDERGRADUATE BUILDING' || title=='MANAGEMENT BUILDING' || title == 'ARTS and SCIENCES BUILDING' || title=='ADMINISTRATION BUILDING'">Floor Plans</button>
            <button id = "vidbut" style="width: 100%">Videos</button>
            <button id = "phobut" style="width: 100%">Photos</button>
          </li>
          <a href="#0" class="cd-popup-close img-replace"></a>
        </div>
      </div>

      <div id="myModal" class="modal" >

      <!-- Modal content -->
      <div class="modal-content" style="height:80%">
        <div class="modal-header">
          <span class="close">Ã—</span>
          <h2>Floor Plan</h2>
        </div>

        <div class="modal-body" style="height:100%">
            <section id="st-container" style="height:100%">
      			<div class="containerz" >
	      			<div id="panzoom" class="distribution-map" style="max-height:400px;" > 
	      				<div class="fp-content fp-display-container" >
            				<img src={{photo}} style="width:100%" >
            			</div>
	      			</div>
      			</div>
      		</section>
      		<span ng-repeat="x in fps">
            	<button class="fp-btn show" ng-click="setPhoto(x)">{{x.flr}}</button>
          </span>
          <button class="button1" id="fp">RESET</button>
        </div>
        <div class="modal-footer">

        </div>
      </div>

      </div>

    </section>
    <script>

        // Get the modal
        var modal = document.getElementById('myModal');

        // Get the button that opens the modal
        var btn = document.getElementById("flrpln");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];

        // When the user clicks the button, open the modal
        btn.onclick = function() {
            modal.style.display = "block";
        }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
            modal.style.display = "none";
        }

        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        function newDoc() {
            window.location.assign("/")
        }

        (function() {
          $('.distribution-map button').on('mousedown touchstart', function( e ) {
              e.stopImmediatePropagation();
          });

          $('.button button5').on('mousedown touchstart', function( e ) {
              e.stopImmediatePropagation();
          });

          $('.button button1').on('mousedown touchstart', function( e ) {
              e.stopImmediatePropagation();
          });

          var $section = $('#st-container');
          var $panzoom = $section.find('.containerz').panzoom({
             $reset: $(".button1"),
          });
          $panzoom.parent().on('mousewheel.focal', function( e ) {
            e.preventDefault();
            var delta = e.delta || e.originalEvent.wheelDelta;
            var zoomOut = delta ? delta < 0 : e.originalEvent.deltaY > 0;
            $panzoom.panzoom('zoom', zoomOut, {
              animate: false,
              panOnlyWhenZoomed: true,
              focal: e
            });
           
          });



          $('.distribution-map').on('mousedown touchstart', function( e ) {
              e.originalEvent();
          });

          })();


    </script>
    <script src="js/popup.js"></script> 
    <script src="js/angular.js"></script>
    <script src="js/app.js"></script>
    <script src="js/MainController.js"></script> 
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  </body>
</html>
